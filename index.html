<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Berkah Printing - Dashboard Modern</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #f72585;
            --success: #4cc9f0;
            --dark: #212529;
            --light: #f8f9fa;
            --white: #ffffff;
            --sidebar-width: 260px;
            --shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background: var(--light); color: var(--dark); scroll-behavior: smooth; overflow-x: hidden; }
        a { text-decoration: none; color: inherit; }
        li { list-style: none; }

        /* --- UTILITY --- */
        .hidden { display: none !important; }
        .btn { padding: 12px 24px; border-radius: 10px; cursor: pointer; border: none; font-weight: 600; transition: 0.3s; display: inline-flex; align-items: center; gap: 8px; font-size: 14px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--secondary); transform: translateY(-2px); }
        .btn-success { background: #06d6a0; color: white; }
        .btn-danger { background: var(--accent); color: white; }
        .btn-warning { background: #ffd166; color: #333; }

        /* --- USER NAV --- */
        nav { background: rgba(255, 255, 255, 0.95); display: flex; justify-content: space-between; padding: 15px 5%; position: fixed; width: 100%; top: 0; z-index: 1000; box-shadow: var(--shadow); backdrop-filter: blur(10px); }
        .logo-area { display: flex; align-items: center; gap: 10px; font-weight: 700; color: var(--primary); font-size: 20px; }
        nav ul { display: flex; gap: 20px; align-items: center; }
        
        @media (max-width: 768px) {
            nav ul li:not(:last-child) { display: none; } /* Sembunyikan menu di HP kecuali tombol Login */
            .hero-content h1 { font-size: 2.5rem !important; }
        }

        /* --- HERO SECTION --- */
        #hero { 
            height: 100vh; 
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.9), rgba(247, 37, 133, 0.8)), url('https://images.unsplash.com/photo-1562654501-a0ccc0fc3fb1?auto=format&fit=crop&w=1350&q=80'); 
            background-size: cover; background-position: center;
            display: flex; align-items: center; justify-content: center; text-align: center; color: white; padding: 0 20px;
        }
        .hero-content h1 { font-size: 3.5rem; font-weight: 800; margin-bottom: 20px; }

        /* --- SERVICE GRID --- */
        .container { padding: 80px 5%; }
        .grid-layanan { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
        .card-layanan { 
            background: var(--white); padding: 30px 15px; border-radius: 20px; text-align: center; 
            transition: 0.3s; box-shadow: var(--shadow); cursor: pointer; border: 1px solid transparent;
        }
        .card-layanan:hover { transform: translateY(-5px); border-color: var(--primary); }
        .card-layanan i { font-size: 40px; color: var(--primary); margin-bottom: 15px; }

        /* --- ADMIN DASHBOARD --- */
        #admin-dashboard { display: flex; min-height: 100vh; background: #f0f2f5; }
        .sidebar { width: var(--sidebar-width); background: var(--dark); color: white; padding: 30px 20px; position: fixed; height: 100%; z-index: 1001; transition: 0.3s; }
        .main-content { margin-left: var(--sidebar-width); width: 100%; padding: 30px; transition: 0.3s; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 15px; box-shadow: var(--shadow); display: flex; align-items: center; gap: 15px; }

        /* Responsive Admin */
        @media (max-width: 1024px) {
            .sidebar { width: 70px; padding: 20px 10px; }
            .sidebar span, .sidebar h3, .sidebar .logo-area span { display: none; }
            .main-content { margin-left: 70px; }
        }

        /* Modal Table */
        .price-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px; }
        .price-table th { background: var(--primary); color: white; padding: 12px; text-align: left; }
        .price-table td { padding: 12px; border-bottom: 1px solid #eee; }

        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center; z-index:3000; backdrop-filter: blur(5px); padding: 20px; }
        .modal-content { background:white; padding:30px; border-radius:20px; width:100%; max-width:600px; max-height: 90vh; overflow-y: auto; }
    </style>
</head>
<body>

    <div id="user-view">
        <nav>
            <div class="logo-area"><i class="fas fa-print"></i> <span>BERKAH PRINTING</span></div>
            <ul>
                <li><a href="#hero">Beranda</a></li>
                <li><a href="#layanan">Layanan</a></li>
                <li><a href="#lokasi">Lokasi</a></li>
                <li><button class="btn btn-primary" onclick="showPage('login-page')">Admin</button></li>
            </ul>
        </nav>

        <header id="hero">
            <div class="hero-content">
                <h1>Cetak Cepat,<br>Kualitas Hebat.</h1>
                <p>Solusi percetakan terpercaya di Kopang. Kualitas premium, harga teman.</p>
                <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <a href="#layanan" class="btn btn-primary">Lihat Daftar Harga</a>
                    <a href="https://wa.me/6287860180561" class="btn btn-success"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                </div>
            </div>
        </header>

        <section id="layanan" class="container">
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2rem;">Layanan Kami</h2>
                <p style="color: #666;">Pilih kategori untuk melihat harga detail</p>
            </div>
            <div class="grid-layanan" id="user-layanan-grid"></div>
        </section>

        <section id="lokasi" class="container" style="background: white;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px;">
                <div>
                    <h2 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-map-marker-alt"></i> Lokasi & Jam Buka</h2>
                    <p style="margin-bottom: 10px;"><strong>Alamat:</strong> Kopang Rembiga, Kec. Kopang, Kabupaten Lombok Tengah, Nusa Tenggara Bar. 83553</p>
                    <p style="margin-bottom: 10px;"><strong>Jam Operasional:</strong></p>
                    <ul style="background: var(--light); padding: 15px; border-radius: 10px; font-size: 14px;">
                        <li style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>Senin - Sabtu:</span> <span>08.00 - 21.00 WITA</span></li>
                        <li style="display: flex; justify-content: space-between; color: var(--accent);"><span>Minggu:</span> <span>Tutup (Janji Temu)</span></li>
                    </ul>
                </div>
                <div>
                    <iframe 
                        width="100%" 
                        height="300" 
                        style="border-radius: 20px; border:0; box-shadow: var(--shadow);" 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15771.551062085443!2d116.34584445!3d-8.6355605!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2d6b96e95d5d677d%3A0xc3f7a14787a71644!2sKopang%20Rembiga%2C%20Kec.%20Kopang%2C%20Kabupaten%20Lombok%20Tengah!5e0!3m2!1sid!2sid!4v1700000000000!5m2!1sid!2sid" 
                        allowfullscreen="" 
                        loading="lazy">
                    </iframe>
                </div>
            </div>
        </section>

        <footer style="background: var(--dark); color: white; padding: 30px; text-align: center; font-size: 14px;">
            <p>&copy; 2026 Berkah Printing Kopang. All Rights Reserved.</p>
        </footer>
    </div>

    <div id="login-page" class="hidden" style="background: var(--primary); height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;">
        <div class="modal-content" style="max-width: 350px; text-align: center;">
            <i class="fas fa-user-shield" style="font-size: 40px; color: var(--primary); margin-bottom: 15px;"></i>
            <h2 style="margin-bottom: 20px;">Admin Login</h2>
            <input type="text" id="user" placeholder="Username" style="width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 10px;">
            <input type="password" id="pass" placeholder="Password" style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 10px;">
            <button class="btn btn-primary" style="width: 100%; justify-content: center;" onclick="login()">Masuk Sekarang</button>
            <p onclick="showPage('user-view')" style="margin-top: 20px; cursor: pointer; color: var(--accent); font-size: 13px;">Kembali ke Beranda</p>
        </div>
    </div>

    <div id="admin-dashboard" class="hidden">
        <div class="sidebar">
            <div class="logo-area" style="color: white; margin-bottom: 30px;"><i class="fas fa-print"></i> <span>BERKAH</span></div>
            <h3 style="font-size: 11px; color: #555; margin-bottom: 10px;">MENU UTAMA</h3>
            <ul>
                <li id="menu-overview" class="active" onclick="switchTab('overview')"><i class="fas fa-chart-pie"></i> <span>Statistik</span></li>
                <li id="menu-report" onclick="switchTab('report')"><i class="fas fa-file-invoice-dollar"></i> <span>Laporan Piutang</span></li>
            </ul>
            <h3 style="font-size: 11px; color: #555; margin: 20px 0 10px 0;">DATA PRODUK</h3>
            <ul id="sidebar-menu-categories"></ul>
            <button class="btn btn-danger" style="width: 100%; margin-top: 30px; padding: 10px;" onclick="logout()">Logout</button>
        </div>

        <div class="main-content">
            <div id="tab-overview">
                <h2 style="margin-bottom: 20px;">Ringkasan Performa</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div style="background: #e7f3ff; color: var(--primary); padding: 15px; border-radius: 12px;"><i class="fas fa-wallet"></i></div>
                        <div><p style="font-size: 12px; color: #888;">Omzet Bulan Ini</p><h3 id="stat-revenue">Rp 0</h3></div>
                    </div>
                    <div class="stat-card">
                        <div style="background: #fff0f6; color: var(--accent); padding: 15px; border-radius: 12px;"><i class="fas fa-hand-holding-usd"></i></div>
                        <div><p style="font-size: 12px; color: #888;">Total Piutang</p><h3 id="stat-debt" style="color: var(--accent);">Rp 0</h3></div>
                    </div>
                </div>
                <div style="background: white; padding: 20px; border-radius: 20px; box-shadow: var(--shadow);">
                    <canvas id="salesChart" height="100"></canvas>
                </div>
            </div>

            <div id="tab-manage" class="hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 id="admin-current-title">Kelola</h2>
                    <button class="btn btn-success" onclick="openForm()">+ Produk</button>
                </div>
                <div style="background: white; border-radius: 20px; overflow: hidden; box-shadow: var(--shadow);">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 15px; text-align: left;">Produk</th>
                                <th style="padding: 15px; text-align: left;">Harga</th>
                                <th style="padding: 15px; text-align: center;">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="admin-table-body"></tbody>
                    </table>
                </div>
            </div>

            <div id="tab-report" class="hidden">
                <h2 style="margin-bottom: 20px;">Daftar Piutang Pelanggan</h2>
                <div style="background: white; border-radius: 20px; padding: 20px; box-shadow: var(--shadow);">
                    <table style="width: 100%;">
                        <thead>
                            <tr style="text-align: left; color: #888; font-size: 12px;">
                                <th style="padding: 10px;">Nama</th>
                                <th style="padding: 10px;">Jumlah</th>
                                <th style="padding: 10px;">Status</th>
                            </tr>
                        </thead>
                        <tbody id="debt-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-detail" class="modal hidden">
        <div class="modal-content">
            <h2 id="det-title" style="color: var(--primary); margin-bottom: 15px;">Detail Harga</h2>
            <div id="det-content"></div>
            <button class="btn btn-danger" style="width: 100%; margin-top: 20px; justify-content: center;" onclick="closeModal('modal-detail')">Tutup</button>
        </div>
    </div>

    <div id="modal-form" class="modal hidden">
        <div class="modal-content">
            <h3 id="form-title">Tambah/Edit Data</h3><br>
            <input type="hidden" id="edit-id">
            <input type="text" id="field-nama" placeholder="Nama Layanan" style="width:100%; padding:12px; margin-bottom:10px; border:1px solid #ddd; border-radius:10px;">
            <input type="number" id="field-harga" placeholder="Harga (Rp)" style="width:100%; padding:12px; margin-bottom:10px; border:1px solid #ddd; border-radius:10px;">
            <textarea id="field-desc" placeholder="Keterangan" style="width:100%; height:80px; padding:12px; border:1px solid #ddd; border-radius:10px; margin-bottom:10px;"></textarea>
            <div style="display: flex; gap: 10px;">
                <button class="btn" style="flex: 1; justify-content: center;" onclick="closeModal('modal-form')">Batal</button>
                <button class="btn btn-primary" style="flex: 1; justify-content: center;" onclick="saveData()">Simpan Data</button>
            </div>
        </div>
    </div>

    <script>
        // --- DATA & KONFIGURASI ---
        const categories = ["Photocopy", "Print", "Cetak Foto", "Laminating", "Penjilidan", "Undangan", "Banner", "ATK"];
        let db = JSON.parse(localStorage.getItem('berkah_db')) || {
            "Cetak Foto": [
                { id: 1, nama: "Cetak 2x3", harga: 2000, desc: "Photo Paper Premium" },
                { id: 2, nama: "Cetak 3x4", harga: 2500, desc: "Photo Paper Premium" },
                { id: 3, nama: "Cetak 4x6", harga: 3000, desc: "Photo Paper Premium" }
            ]
        };
        let sales = JSON.parse(localStorage.getItem('berkah_sales')) || [];
        let currentCategory = "";
        let salesChart;

        // Inisialisasi Kategori Kosong
        categories.forEach(cat => { if(!db[cat]) db[cat] = []; });

        // --- NAVIGASI HALAMAN ---
        function showPage(pageId) {
            document.querySelectorAll('#user-view, #login-page, #admin-dashboard').forEach(p => p.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            
            if(pageId === 'admin-dashboard') {
                renderSidebar();
                updateStats();
                initChart();
                switchTab('overview');
            }
            if(pageId === 'user-view') renderUserGrid();
        }

        function switchTab(tab) {
            document.querySelectorAll('#tab-overview, #tab-manage, #tab-report').forEach(t => t.classList.add('hidden'));
            document.querySelectorAll('.sidebar ul li').forEach(li => li.classList.remove('active'));
            
            if(tab === 'overview') {
                document.getElementById('tab-overview').classList.remove('hidden');
                document.getElementById('menu-overview').classList.add('active');
            } else if (tab === 'report') {
                document.getElementById('tab-report').classList.remove('hidden');
                document.getElementById('menu-report').classList.add('active');
                renderReport();
            } else {
                currentCategory = tab;
                document.getElementById('tab-manage').classList.remove('hidden');
                document.getElementById('admin-current-title').innerText = tab;
                const activeLi = document.getElementById('cat-' + tab.replace(/\s/g, ''));
                if(activeLi) activeLi.classList.add('active');
                renderAdminTable();
            }
        }

        // --- FUNGSI USER ---
        function renderUserGrid() {
            const grid = document.getElementById('user-layanan-grid');
            grid.innerHTML = '';
            categories.forEach(cat => {
                grid.innerHTML += `
                    <div class="card-layanan" onclick="showUserDetail('${cat}')">
                        <i class="fas ${getIcon(cat)}"></i>
                        <h4 style="font-size: 14px;">${cat}</h4>
                    </div>
                `;
            });
        }

        function showUserDetail(cat) {
            const data = db[cat];
            document.getElementById('det-title').innerText = cat;
            let html = `<table class="price-table"><tr><th>Layanan</th><th>Harga</th></tr>`;
            if (data.length === 0) {
                html += `<tr><td colspan="2" style="text-align:center; padding: 20px;">Belum ada data harga.</td></tr>`;
            } else {
                data.forEach(item => {
                    html += `<tr><td><b>${item.nama}</b><br><small style="color:#888">${item.desc || ''}</small></td>
                             <td><b style="color:var(--primary)">${formatRupiah(item.harga)}</b></td></tr>`;
                });
            }
            html += `</table>`;
            document.getElementById('det-content').innerHTML = html;
            document.getElementById('modal-detail').classList.remove('hidden');
        }

        // --- FUNGSI ADMIN ---
        function login() {
            const u = document.getElementById('user').value;
            const p = document.getElementById('pass').value;
            if(u === 'admin' && p === 'admin123') {
                showPage('admin-dashboard');
            } else {
                alert("Username atau Password Salah!");
            }
        }

        function logout() {
            if(confirm("Keluar dari sistem admin?")) showPage('user-view');
        }

        function renderSidebar() {
            const container = document.getElementById('sidebar-menu-categories');
            container.innerHTML = '';
            categories.forEach(cat => {
                container.innerHTML += `<li id="cat-${cat.replace(/\s/g, '')}" onclick="switchTab('${cat}')"><i class="fas ${getIcon(cat)}"></i> <span>${cat}</span></li>`;
            });
        }

        function renderAdminTable() {
            const body = document.getElementById('admin-table-body');
            body.innerHTML = '';
            db[currentCategory].forEach((item) => {
                body.innerHTML += `
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 15px;"><b>${item.nama}</b></td>
                        <td style="padding: 15px;">${formatRupiah(item.harga)}</td>
                        <td style="padding: 15px; text-align: center; display: flex; gap: 5px; justify-content: center;">
                            <button class="btn btn-success" style="padding: 5px 10px;" onclick="addTransaction(${item.harga}, 'lunas')"><i class="fas fa-check"></i></button>
                            <button class="btn btn-warning" style="padding: 5px 10px;" onclick="addTransaction(${item.harga}, 'piutang')"><i class="fas fa-clock"></i></button>
                            <button class="btn btn-danger" style="padding: 5px 10px;" onclick="deleteData(${item.id})"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
        }

        function addTransaction(amount, status) {
            let customer = "Tunai";
            if(status === 'piutang') {
                customer = prompt("Masukkan Nama Pelanggan:");
                if(!customer) return;
            }
            const now = new Date();
            sales.push({
                id: Date.now(),
                customer: customer,
                amount: parseInt(amount),
                status: status,
                month: now.getMonth() + 1,
                date: now.toLocaleDateString('id-ID')
            });
            localStorage.setItem('berkah_sales', JSON.stringify(sales));
            alert("Data Berhasil Dicatat!");
            updateStats();
            if(status === 'piutang') renderReport();
        }

        function renderReport() {
            const body = document.getElementById('debt-table-body');
            body.innerHTML = '';
            sales.filter(s => s.status === 'piutang').forEach(s => {
                body.innerHTML += `
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 10px;">${s.customer}<br><small>${s.date}</small></td>
                        <td style="padding: 10px; color: var(--accent); font-weight: bold;">${formatRupiah(s.amount)}</td>
                        <td style="padding: 10px;"><button class="btn btn-success" style="padding: 5px;" onclick="payDebt(${s.id})">Lunas</button></td>
                    </tr>
                `;
            });
        }

        function payDebt(id) {
            const idx = sales.findIndex(s => s.id === id);
            sales[idx].status = 'lunas';
            localStorage.setItem('berkah_sales', JSON.stringify(sales));
            renderReport();
            updateStats();
        }

        function updateStats() {
            const now = new Date();
            const revenue = sales.filter(s => s.status === 'lunas' && s.month === (now.getMonth()+1)).reduce((a, b) => a + b.amount, 0);
            const debt = sales.filter(s => s.status === 'piutang').reduce((a, b) => a + b.amount, 0);
            document.getElementById('stat-revenue').innerText = formatRupiah(revenue);
            document.getElementById('stat-debt').innerText = formatRupiah(debt);
        }

        function initChart() {
            const ctx = document.getElementById('salesChart').getContext('2d');
            if(salesChart) salesChart.destroy();
            salesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Minggu 1', 'Minggu 2', 'Minggu 3', 'Minggu 4'],
                    datasets: [{
                        label: 'Pendapatan',
                        data: [12000, 19000, 15000, 25000], // Dummy data trend
                        borderColor: '#4361ee',
                        tension: 0.4,
                        fill: true,
                        backgroundColor: 'rgba(67, 97, 238, 0.1)'
                    }]
                },
                options: { plugins: { legend: { display: false } }, scales: { y: { display: false } } }
            });
        }

        // --- UTILS ---
        function formatRupiah(num) { return "Rp " + Number(num).toLocaleString('id-ID'); }
        function getIcon(cat) {
            const icons = {"Photocopy":"fa-copy","Print":"fa-print","Cetak Foto":"fa-image","Laminating":"fa-layer-group","Penjilidan":"fa-book","Undangan":"fa-envelope","Banner":"fa-ad","ATK":"fa-pen"};
            return icons[cat] || "fa-star";
        }
        function openForm(id = null) {
            document.getElementById('edit-id').value = id || '';
            document.getElementById('modal-form').classList.remove('hidden');
        }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        
        function saveData() {
            const nama = document.getElementById('field-nama').value;
            const harga = document.getElementById('field-harga').value;
            const desc = document.getElementById('field-desc').value;
            if(!nama || !harga) return alert("Nama & Harga wajib diisi!");
            
            db[currentCategory].push({ id: Date.now(), nama, harga, desc });
            localStorage.setItem('berkah_db', JSON.stringify(db));
            closeModal('modal-form');
            renderAdminTable();
        }

        function deleteData(id) {
            if(confirm("Hapus produk ini?")) {
                db[currentCategory] = db[currentCategory].filter(x => x.id != id);
                localStorage.setItem('berkah_db', JSON.stringify(db));
                renderAdminTable();
            }
        }

        window.onload = () => { renderUserGrid(); };
    </script>
</body>
</html>
